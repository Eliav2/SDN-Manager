(this["webpackJsonpreact-xarrows-examples"]=this["webpackJsonpreact-xarrows-examples"]||[]).push([[0],{105:function(e,t,n){},107:function(e,t,n){},108:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(9),i=(n(89),n(7)),c=(n(90),n(16)),l=n(28),s=n(3),d=n(77),u=n.n(d),p=(n(91),n(42)),f=o.a.memo((function(e){var t=e.line,n=Object(a.useContext)(ce),r=Object(a.useState)({color:t.color}),c=Object(i.a)(r,2),l=c[0],d=c[1],u={consoleWarning:!1,passProps:{onMouseEnter:function(){return d({color:"IndianRed"})},onMouseLeave:function(){return d({color:t.color})},onClick:function(e){e.stopPropagation(),n.setSelected({id:{start:t.start,end:t.end},shape:"arrow"}),n.setActionState("Normal")},cursor:"pointer"}},f=l.color,m=t.start.includes(":<input>")?"right":"auto",b=t.end.includes(":<output>")?"left":"auto";return n.selected&&"arrow"===n.selected.shape&&n.selected.id.start===t.start&&n.selected.id.end===t.end&&(f="red"),o.a.createElement(p.a,Object.assign({startAnchor:m,endAnchor:b},Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},u),t),l),{},{color:f})))}),(function(){return!1})),m=n(32),b=n.n(m),h=n(142),v=n(145),y=n(71),E=n.n(y),O=n(70),_=n.n(O),g=n(46),w=n.n(g),j=n(69),x=n.n(j),S=n(65),P=n.n(S),C=n(52),T=[["in_port","Switch input port (int)",'{"in_port": 7}'],["in_phy_port","Switch physical input port (int)",'{"in_phy_port": 5, "in_port": 3}'],["metadata","Metadata passed between tables (int or string)",'{"metadata": 12345} or {"metadata": "0x1212/0xffff"}'],["eth_src","Ethernet source address (string)",'{"eth_src": "aa:bb:cc:11:22:33"}'],["dl_src","Ethernet source address (string)",'{"eth_src": "aa:bb:cc:11:22:33"}'],["eth_dst","Ethernet destination address (string)",'{"eth_dst": "aa:bb:cc:11:22:33/00:00:00:00:ff:ff"}'],["dl_dst","Ethernet destination address (string)",'{"eth_dst": "aa:bb:cc:11:22:33/00:00:00:00:ff:ff"}'],["eth_type","Ethernet frame type (int)",'{"eth_type": 2048}'],["dl_type","Ethernet frame type (int)",'{"eth_type": 2048}'],["vlan_vid","VLAN id (int or string)","See Example of VLAN ID match field"],["vlan_pcp","VLAN priority (int)",'{"vlan_pcp": 3, "vlan_vid": 3}'],["ip_dscp","IP DSCP (6 bits in ToS field) (int)",'{"ip_dscp": 3, "eth_type": 2048}'],["ip_ecn","IP ECN (2 bits in ToS field) (int)",'{"ip_ecn": 0, "eth_type": 34525}'],["ip_proto","IP protocol (int)",'{"ip_proto": 5, "eth_type": 34525}'],["ipv4_src","IPv4 source address (string)",'{"ipv4_src": "192.168.0.1", "eth_type": 2048}'],["ipv4_dst","IPv4 destination address (string)",'{"ipv4_dst": "192.168.10.10/255.255.255.0", "eth_type": 2048}'],["tcp_src","TCP source port (int)",'{"tcp_src": 3, "ip_proto": 6, "eth_type": 2048}'],["tcp_dst","TCP destination port (int)",'{"tcp_dst": 5, "ip_proto": 6, "eth_type": 2048}'],["udp_src","UDP source port (int)",'{"udp_src": 2, "ip_proto": 17, "eth_type": 2048}'],["udp_dst","UDP destination port (int)",'{"udp_dst": 6, "ip_proto": 17, "eth_type": 2048}'],["sctp_src","SCTP source port (int)",'{"sctp_src": 99, "ip_proto": 132, "eth_type": 2048}'],["sctp_dst","SCTP destination port (int)",'{"sctp_dst": 99, "ip_proto": 132, "eth_type": 2048}'],["icmpv4_type","ICMP type (int)",'{"icmpv4_type": 5, "ip_proto": 1, "eth_type": 2048}'],["icmpv4_code","ICMP code (int)",'{"icmpv4_code": 6, "ip_proto": 1, "eth_type": 2048}'],["arp_op","ARP opcode (int)",'{"arp_op": 3, "eth_type": 2054}'],["arp_spa","ARP source IPv4 address (string)",'{"arp_spa": "192.168.0.11", "eth_type": 2054}'],["arp_tpa","ARP target IPv4 address (string)",'{"arp_tpa": "192.168.0.44/24", "eth_type": 2054}'],["arp_sha","ARP source hardware address (string)",'{"arp_sha": "aa:bb:cc:11:22:33", "eth_type": 2054}'],["arp_tha","ARP target hardware address (string)",'{"arp_tha": "aa:bb:cc:11:22:33/00:00:00:00:ff:ff", "eth_type": 2054}'],["ipv6_src","IPv6 source address (string)",'{"ipv6_src": "2001::aaaa:bbbb:cccc:1111", "eth_type": 34525}'],["ipv6_dst","IPv6 destination address (string)",'{"ipv6_dst": "2001::ffff:cccc:bbbb:1111/64", "eth_type": 34525}'],["ipv6_flabel","IPv6 Flow Label (int)",'{"ipv6_flabel": 2, "eth_type": 34525}'],["icmpv6_type","ICMPv6 type (int)",'{"icmpv6_type": 3, "ip_proto": 58, "eth_type": 34525}'],["icmpv6_code","ICMPv6 code (int)",'{"icmpv6_code": 4, "ip_proto": 58, "eth_type": 34525}'],["ipv6_nd_target","Target address for Neighbor Discovery (string)",'{"ipv6_nd_target": "2001::ffff:cccc:bbbb:1111", "icmpv6_type": 135, "ip_proto": 58, "eth_type": 34525}'],["ipv6_nd_sll","Source link-layer for Neighbor Discovery (string)",'{"ipv6_nd_sll": "aa:bb:cc:11:22:33", "icmpv6_type": 135, "ip_proto": 58, "eth_type": 34525}'],["ipv6_nd_tll","Target link-layer for Neighbor Discovery (string)",'{"ipv6_nd_tll": "aa:bb:cc:11:22:33", "icmpv6_type": 136, "ip_proto": 58, "eth_type": 34525}'],["mpls_label","MPLS label (int)",'{"mpls_label": 3, "eth_type": 34888}'],["mpls_tc","MPLS Traffic Class (int)",'{"mpls_tc": 2, "eth_type": 34888}'],["mpls_bos","MPLS BoS bit (int) (Openflow1.3+)",'{"mpls_bos": 1, "eth_type": 34888}'],["pbb_isid","PBB I-SID (int or string) (Openflow1.3+)",'{"pbb_isid": 5, "eth_type": 35047} or{"pbb_isid": "0x05/0xff", "eth_type": 35047}'],["tunnel_id","Logical Port Metadata (int or string) (Openflow1.3+)",'{"tunnel_id": 7} or {"tunnel_id": "0x07/0xff"}'],["ipv6_exthdr","IPv6 Extension Header pseudo-field (int or string) (Openflow1.3+)",'{"ipv6_exthdr": 3, "eth_type": 34525} or {"ipv6_exthdr": "0x40/0x1F0", "eth_type": 34525}']],N=[["OUTPUT",'Output packet from "port"','{"type": "OUTPUT", "port": 3}'],["COPY_TTL_OUT","Copy TTL outwards",'{"type": "COPY_TTL_OUT"}'],["COPY_TTL_IN","Copy TTL inwards",'{"type": "COPY_TTL_IN"}'],["SET_MPLS_TTL",'Set MPLS TTL using "mpls_ttl"','{"type": "SET_MPLS_TTL", "mpls_ttl": 64}'],["DEC_MPLS_TTL","Decrement MPLS TTL",'{"type": "DEC_MPLS_TTL"}'],["PUSH_VLAN",'Push a new VLAN tag with "ethertype"','{"type": "PUSH_VLAN", "ethertype": 33024}'],["POP_VLAN","Pop the outer VLAN tag",'{"type": "POP_VLAN"}'],["PUSH_MPLS",'Push a new MPLS tag with "ethertype"','{"type": "PUSH_MPLS", "ethertype": 34887}'],["POP_MPLS",'Pop the outer MPLS tag with "ethertype"','{"type": "POP_MPLS", "ethertype": 2054}'],["SET_QUEUE",'Set queue id using "queue_id" when outputting to a port','{"type": "SET_QUEUE", "queue_id": 7}'],["GROUP",'Apply group identified by "group_id"','{"type": "GROUP", "group_id": 5}'],["SET_NW_TTL",'Set IP TTL using "nw_ttl"','{"type": "SET_NW_TTL", "nw_ttl": 64}'],["DEC_NW_TTL","Decrement IP TTL",'{"type": "DEC_NW_TTL"}'],["SET_FIELD",'Set a "field" using "value" (The set of keywords available for "field" is the same as match field)',"See Example of set-field action"],["PUSH_PBB",'Push a new PBB service tag with "ethertype" (Openflow1.3+)','{"type": "PUSH_PBB", "ethertype": 35047}'],["POP_PBB","Pop the outer PBB service tag (Openflow1.3+)",'{"type": "POP_PBB"}'],["EXPERIMENTER",'Extensible action for the experimenter (Set "base64" or "ascii" to "data_type" field)','{"type": "EXPERIMENTER", "experimenter": 101, "data": "AAECAwQFBgc=", "data_type": "base64"}'],["GOTO_TABLE",'(Instruction) Setup the next table identified by "table_id"','{"type": "GOTO_TABLE", "table_id": 8}'],["WRITE_METADATA",'(Instruction) Setup the metadata field using "metadata" and "metadata_mask"','{"type": "WRITE_METADATA", "metadata": 0x3, "metadata_mask": 0x3}'],["METER",'(Instruction) Apply meter identified by "meter_id" (deprecated in Openflow1.5)','{"type": "METER", "meter_id": 3}'],["WRITE_ACTIONS","(Instruction) Write the action(s) onto the datapath action set",'{"type": "WRITE_ACTIONS", actions":[{"type":"POP_VLAN",},{ "type":"OUTPUT", "port": 2}]}'],["CLEAR_ACTIONS","(Instruction) Clears all actions from the datapath action set",'{"type": "CLEAR_ACTIONS"}']],k=n(14),B=n.n(k),D=function(e){var t=e.sectionName,n=e.fields,r=e.details,i=e.setDetails;Object(a.useContext)(ce);Object(a.useEffect)((function(){}),[r]);var c=function(e){i((function(t){var n=Object(s.a)({},t);return delete n[e],n}))},d=function(e,t){i(Object(s.a)({},Object.assign(r,Object(l.a)({},t,e))))};return o.a.createElement("div",{className:"section"},o.a.createElement(A,{handleAddField:function(e){i(Object(s.a)({},Object.assign(r,Object(l.a)({},e,""))))},fields:n,secName:t}),o.a.createElement("div",{className:"sectionHeader"},t,":"),Object.keys(r).map((function(e){return o.a.createElement(L,{key:e,name:e,value:r[e],handleDelField:c,handleSaveFieldChange:d})})))},L=function(e){var t=e.name,n=e.value,a=e.handleDelField,r=e.handleSaveFieldChange;return o.a.createElement("div",{className:"propBox",key:t},o.a.createElement("div",{className:"propField propKey"},o.a.createElement("div",null,t)),o.a.createElement("div",{className:"propField propValue",onMouseDown:function(e){return e.stopPropagation()}},o.a.createElement(h.a,{type:"text",value:n,className:"inputField",placeholder:"Enter Value...",onChange:function(e){return r(e.target.value,t)},style:{fontSize:"0.9em"}})),o.a.createElement(_.a,{titleAccess:"Delete this field",fontSize:"large",className:"button addButton",onClick:function(){return a(t)}}))},A=function(e){var t=e.handleAddField,n=e.fields,r=(e.secName,Object(a.useState)("")),c=Object(i.a)(r,2),l=c[0],s=c[1];return n=n?l?n.filter((function(e){return e[0].includes(l)})):n:[],o.a.createElement(C.a,{trigger:o.a.createElement("div",{className:"button addButton"},o.a.createElement(E.a,{fontSize:"large"})),position:"right top",on:"hover",closeOnDocumentClick:!0,mouseLeaveDelay:400,mouseEnterDelay:0,contentStyle:{border:"none",width:200,transition:"all 1s ease-out"},arrow:!0},o.a.createElement("div",null,o.a.createElement("input",{value:l,type:"text",style:{width:100,border:"none",fontSize:"0.9em"},placeholder:"filter...",onChange:function(e){return s(e.target.value)}}),o.a.createElement("div",{className:"popupMenu"},n.map((function(e){return o.a.createElement(C.a,{key:e[0],trigger:o.a.createElement("div",{key:e[0],className:"menu-item",onClick:function(){return t(e[0])}},e[0]),position:"right top",on:"hover",mouseLeaveDelay:200,mouseEnterDelay:200,contentStyle:{border:"none",width:200},arrow:!0},o.a.createElement(C.a,{key:e[0],trigger:o.a.createElement("div",null,e[1]),position:"top center",on:"hover",mouseLeaveDelay:0,mouseEnterDelay:0,contentStyle:{border:"none",width:200},arrow:!0},e[2]))})))))},I=function(e){var t=e.flow,n=Object(a.useContext)(ce),r=Object(a.useState)(Object(s.a)({},t.details.match)),c=Object(i.a)(r,2),l=c[0],d=c[1],u=Object(a.useState)(Object(s.a)({},t.details.actions)),p=Object(i.a)(u,2),f=p[0],m=p[1],h={match:Object(s.a)({},l),actions:Object(s.a)({},f),priority:t.details.priority=1},y=function(e){var a=Object(s.a)(Object(s.a)({},t),{},{details:e||h,isSynced:!0,box:Object(s.a)(Object(s.a)({},t.box),{},{flowDetailsModalOpen:!1})});n.updateFlowOnServer(a)};return o.a.createElement(b.a,{enableUserSelectHack:!1,defaultPosition:{x:t.box.x,y:t.box.y-100}},o.a.createElement("div",{className:"menuWindowContainer",onClick:function(e){return e.stopPropagation()}},o.a.createElement("div",{style:{display:"flex",alignSelf:"flex-end"}},!1===Object(k.isEqual)(t.details,Object(s.a)(Object(s.a)({},t.details),h))&&t.isSynced?o.a.createElement(o.a.Fragment,null,o.a.createElement(P.a,{titleAccess:"Update changes of this flow entry on the vSwitch",className:"button",fontSize:"large",style:{position:"relative"},onClick:function(){return y()}})):null,o.a.createElement(w.a,{fontSize:"large",className:"button closeButton",onClick:function(){n.updateBoxOnUi(Object(s.a)(Object(s.a)({},t.box),{},{flowDetailsModalOpen:!1}))},titleAccess:"Close"}),t.isSynced?null:o.a.createElement(x.a,{fontSize:"large",className:"button closeButton",onClick:function(){n.addFlowToServer(Object(s.a)(Object(s.a)({},t),{},{details:h}),(function(e){return y(e)}))},titleAccess:"Confirm new flow"})),o.a.createElement("div",{className:"header"},o.a.createElement(v.a,{defaultValue:t.box.name,inputProps:{"aria-label":"naked",style:{textAlign:"center"}},style:{fontSize:"1.4em"},onChange:function(e){return n.updateFlowName(t.box.id,e.target.value)}})),o.a.createElement("hr",{style:{width:"90%"}}),o.a.createElement("div",{className:"propsContainer"},o.a.createElement(D,{sectionName:"match",fields:T,details:l,setDetails:d}),o.a.createElement(D,{sectionName:"actions",fields:N,details:f,setDetails:m}))))},M=n(10),U={position:"absolute",width:10,height:10,borderRadius:"50%",background:"black"},R={left:{left:0,top:"50%",transform:"translate(-50%, -50%)"},right:{left:"100%",top:"50%",transform:"translate(-50%, -50%)"},top:{left:"50%",top:0,transform:"translate(-50%, -50%)"},bottom:{left:"50%",top:"100%",transform:"translate(-50%, -50%)"}},F=function(e){var t=e.element,n=e.handler,r=e.elemPos,c=void 0===r?{x:0,y:0}:r,l=Object(a.useContext)(ce),d=Object(a.useRef)(),u=Object(a.useState)({}),f=Object(i.a)(u,2),m=f[0],b=f[1],h=Object(a.useState)(!1),v=Object(i.a)(h,2),y=v[0],E=v[1];return o.a.createElement(o.a.Fragment,{key:n},o.a.createElement("div",{className:"connectPoint",style:Object(s.a)(Object(s.a)(Object(s.a)(Object(s.a)({},U),R[n]),m),{},{zIndex:1}),draggable:!0,onMouseDown:function(e){return e.stopPropagation()},onDragStart:function(e){E(!0),l.setSelected(t),l.handleBoxClick(e,t),l.setActionState("Add Connections"),e.dataTransfer.setData("arrow",t.id)},onDrag:function(e){b({position:"fixed",left:e.clientX-c.x,top:e.clientY-c.y,transform:"none",opacity:0})},ref:d,onDragEnd:function(e){b({}),E(!1),l.handleSelect(null)}}),y?o.a.createElement(p.a,{start:t.id,end:d,startAnchor:n,advanced:{passProps:{divContainer:{style:{zIndex:1}}}}}):null)},W=function(e){var t=e.element,n=e.handlers,a=void 0===n?["left","right","bottom","top"]:n,r=e.elemPos,i=void 0===r?{x:0,y:0}:r;return o.a.createElement(o.a.Fragment,null,a.map((function(e){return o.a.createElement(F,{handler:e,element:t,elemPos:i,key:e})})))},z=n(144),V=o.a.memo((function(e){var t=e.port,n=e.portPolarity,r=(e.lines,Object(a.useContext)(ce)),c=Object(a.useState)(!1),l=Object(i.a)(c,2),s=l[0],d=l[1],u=r.chooseBoxBackground(t);return t.ref=Object(a.useRef)(),o.a.createElement("div",null,o.a.createElement(z.a,{interactive:!0,arrow:!0,enterDelay:800,title:Object.keys(t.port).map((function(e,n){return o.a.createElement("div",{key:e,style:{fontSize:13,marginBottom:2}},e,": ",t.port[e],o.a.createElement("br",null))}))},o.a.createElement("div",null,o.a.createElement("div",{ref:t.ref,className:"portBox hoverMarker",style:{background:u},onClick:function(e){!1===s&&r.handleBoxClick(e,t),d(!1)},id:t.id,onDragOver:function(e){return e.preventDefault()},onDrop:function(e){e.dataTransfer.getData("arrow")!==t.id&&"output"===n&&r.addLine({startBoxId:e.dataTransfer.getData("arrow"),endBoxId:t.id})}},o.a.createElement(W,{element:t,handlers:"input"===n?["right"]:[]}),o.a.createElement("div",null,t.name,o.a.createElement("br",null),"(...",t.port.hw_addr.slice(-5),")",o.a.createElement("br",null),"(",t.port.port_no,")")))))})),J=o.a.memo((function(e){var t=e.ports,n=e.portPolarity,r=e.lines,i=void 0===r?[]:r;Object(a.useContext)(ce);return o.a.createElement("div",{className:"portsBarStyle",id:"portsInputsBar"},o.a.createElement("u",{className:"portTitleStyle"},n,"s"),t.map((function(e){var t=e.id+":<".concat(n,">");return o.a.createElement(V,{key:t,port:Object(s.a)(Object(s.a)({},e),{},{id:t}),portPolarity:n,lines:i})})))})),H=o.a.memo((function(e){return null})),G=n(49),Y=n.n(G),q=n(74),X=n.n(q),Q=n(75),K=n.n(Q),Z=function(e){var t=e.flowEntry,n=(e.i,Object(a.useContext)(ce)),r=t.details,i=t.box.visible?"LemonChiffon":void 0;return o.a.createElement(z.a,{arrow:!0,enterDelay:800,title:Object.keys(r).filter((function(e){return"actions"!==e&&"match"!==e})).map((function(e){return o.a.createElement("div",{key:e,style:{fontSize:12}},e,": ",r[e])}))},o.a.createElement("div",{className:"propBoxEntryPreview grayHover",style:{background:i},onClick:function(){return n.toggleFlowVisibility(t)}},o.a.createElement("div",{style:{width:20}},t.box.name,":"),o.a.createElement("div",{style:{flex:.9}},o.a.createElement("ul",null,Object.keys(r.match).map((function(e){return o.a.createElement("li",{key:e},e,": ",r.match[e])})))),o.a.createElement("div",{style:{width:30}},"--",">"),o.a.createElement("div",{style:{flex:.9}},JSON.stringify(r.actions,null,2)),o.a.createElement(X.a,{fontSize:"large",className:"button",onClick:function(e){e.stopPropagation(),n.updateBoxOnUi(Object(s.a)(Object(s.a)({},t.box),{},{flowDetailsModalOpen:!t.box.flowDetailsModalOpen}))}}),o.a.createElement(K.a,{fontSize:"large",className:"button",onClick:function(e){e.stopPropagation(),n.delFlow(t)}})))},$=function(e){var t=e.setSwitchDetailsWindow,n=e.flowEntries,a=void 0===n?[]:n;return o.a.createElement(b.a,{enableUserSelectHack:!1},o.a.createElement("div",{className:"switchDetailsWindow",onClick:function(e){return e.stopPropagation()}},o.a.createElement(w.a,{fontSize:"large",className:"button closeButton",onClick:function(){return t(!1)}}),o.a.createElement("div",{className:"header"},"Flow Entries"),o.a.createElement("hr",{style:{width:"90%"}}),a.map((function(e,t){return e.isSynced?o.a.createElement(Z,Object.assign({key:JSON.stringify(e.details.match)},{flowEntry:e,i:t})):null}))))},ee=function(){return o.a.createElement("div",{className:"toolboxMenu"},o.a.createElement("div",{className:"toolboxTitle"},"Drag & drop me!"),o.a.createElement("hr",null),o.a.createElement("div",{className:"toolboxContainer"},se.map((function(e){return o.a.createElement("div",{key:e,className:e+" grabble",onDragStart:function(t){return t.dataTransfer.setData("shape",e)},draggable:!0},e)}))))},te=(n(105),n(76)),ne=n.n(te),ae={modBox:["Edit Mods","Add Connections","Remove Connections","Hide","Delete"],portBox:["Add Connections","Remove Connections"],portBoxOut:[],arrow:["Remove Connection"]};var oe=o.a.memo((function(){var e=Object(a.useContext)(ce);return o.a.createElement("div",{className:"topBarStyle",style:{height:null===e.selected?"0":"60px"},onClick:function(e){return e.stopPropagation()}},o.a.createElement("div",{className:"topBarLabel",onClick:function(){return e.handleSelect(null)}},o.a.createElement(ne.a,{fontSize:"large",className:" topBarToggleIcon"})),function(){var t=[];switch(e.selected&&(t=ae[e.selected.shape],e.selected.shape.includes("Box")&&e.selected.id.includes(":<output>")&&(t=ae.portBoxOut)),e.actionState){case"Normal":return o.a.createElement("div",{className:"actionBubblesContainer"},t.map((function(t,n){return o.a.createElement("div",{className:"actionBubble",key:n,onClick:function(){return function(t){switch(t){case"Add Connections":e.setActionState("Add Connections");break;case"Remove Connections":e.setActionState("Remove Connections");break;case"Remove Connection":e.removeSelectedLine();break;case"Edit Mods":e.openModsWindowOfSelected();break;case"Hide":e.toggleFlowVisibilityOfSelected();break;case"Delete":e.removeSelectedBox()}}(t)}},t)})));case"Add Connections":return o.a.createElement("div",{className:"actionBubblesContainer"},o.a.createElement("p",null,"To where connect new connection?"),o.a.createElement("div",{className:"actionBubble",onClick:function(){return e.setActionState("Normal")}},"finish"));case"Remove Connections":return o.a.createElement("div",{className:"actionBubblesContainer"},o.a.createElement("p",null,"Which connection to remove?"))}}())})),re=o.a.memo((function(e){var t=Object(a.useContext)(ce),n=e.boxes,r=e.box,l=Object(a.useState)(!1),s=Object(i.a)(l,2),d=s[0],u=s[1];r.shape||(r.shape="modBox"),r.x||(r.x=0),r.y||(r.y=0);var p=function(e,a,o){var r=Object(c.a)(n),i=n.findIndex((function(e){return e.id===o}));r[i].x=a.lastX,r[i].y=a.lastY,t.updateBoxOnUi(r[i])},f=t.chooseBoxBackground(r);if(r.ref=Object(a.useRef)(),r.ref.current){var m=r.ref.current.getBoundingClientRect(),h=m.x,v=m.y;r.clientX=h,r.clientY=v}return null==r.name&&(r.name=r.id),o.a.createElement(b.a,{bounds:"#boxesContainer",onStart:function(e){return e.stopPropagation()},onDrag:function(e,t){p(0,t,r.id)},onStop:function(e,t){return p(0,t,r.id)},position:{x:r.x,y:r.y},grid:[le.draggingGrid[0],le.draggingGrid[1]]},o.a.createElement("div",{ref:r.ref,className:"".concat(r.shape," hoverMarker absolute"),style:{background:f},onClick:function(e){!1===d&&t.handleBoxClick(e,r),u(!1)},id:r.id,onDragOver:function(e){e.stopPropagation(),e.preventDefault()},onDrop:function(e){console.log("box on drop!"),e.dataTransfer.getData("arrow")!==r.id&&t.addLine({startBoxId:e.dataTransfer.getData("arrow"),endBoxId:r.id})}},o.a.createElement("div",null,r.name),o.a.createElement(W,{element:r,elemPos:{x:r.clientX,y:r.clientY}})))})),ie=function(e){var t=e.handleDropBox,n=e.boxes;e.lines;return o.a.createElement("div",{id:"boxesContainer",className:"boxesContainer",onDragOver:function(e){e.stopPropagation(),e.preventDefault()},onDrop:t},o.a.createElement(oe,null),n.map((function(e){return e.visible?o.a.createElement(re,Object.assign({key:e.id},{box:e,boxes:n})):null})))},ce=Object(a.createContext)(null),le={draggingGrid:[1,1]},se=["modBox"],de=function(e){var t=Object(s.a)({},e);for(var n in e)"number"===typeof e[n]&&(t[n]=String(e[n]));return t},ue=function(e){return Object.keys(e).map((function(t){return{type:t,port:Number(e[t])?Number(e[t]):e[t]}}))},pe=function(e){return e.map((function(e){return e.split(":")})).reduce((function(e,t){return Object.assign(e,Object(l.a)({},t[0],t[1]))}),{})},fe=function(e){var t=Object(M.f)().dpid,n=Object(a.useState)(Object(s.a)(Object(s.a)({},e.switches[t]),{},{flowEntries:[],dpid:t})),r=Object(i.a)(n,2),l=r[0],d=r[1],p=Object(a.useState)(l.ports.map((function(e){return{shape:"portBox",id:e.port_no,name:e.name,port:e,ref:null}}))),m=Object(i.a)(p,2),b=m[0],h=m[1],v=Object(a.useState)(!1),y=Object(i.a)(v,2),E=y[0],O=y[1],_=Object(a.useState)(!1),g=Object(i.a)(_,2),w=g[0],j=g[1];Object(a.useEffect)((function(){x()}),[]);var x=function(){fetch(ve+"http://localhost:8080/stats/flow/"+t).then((function(e){return 200!==e.status&&alert(e.status),e.json()})).then((function(e){console.log(e),O(!0);var n=document.getElementById("boxesContainer").getBoundingClientRect();d(Object(s.a)(Object(s.a)({},l),{},{flowEntries:e[t].map((function(e,t){var a=n.width*(.2+.8*Math.random()),o=n.height*(.2+.8*Math.random());return console.log(e),{details:Object(s.a)(Object(s.a)({},e),{},{actions:pe(e.actions)}),visible:!1,isSynced:!0,box:{x:a,y:o,visible:!1,id:JSON.stringify(e.match),name:"flow"+t}}}))}))}))},S=Object(a.useCallback)((function(e){e.box.visible=!e.box.visible,Q(e)}),[l]),P=function(){S(l.flowEntries.find((function(e){return e.box.id===U.id})))},C=Object(a.useState)([]),T=Object(i.a)(C,2),N=T[0],D=T[1],L=Object(a.useState)(null),A=Object(i.a)(L,2),U=A[0],R=A[1],F=Object(a.useState)("Normal"),W=Object(i.a)(F,2),z=W[0],V=W[1],G=Object(a.useCallback)((function(e,t){null===e?(R(null),V("Normal")):R(t)}),[]),q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?Object.values(e.flowEntries).map((function(e){return e.box})):Object.values(l.flowEntries).map((function(e){return e.box}))},X=function(e){d((function(t){var n=Object(s.a)({},t);return n.flowEntries.find((function(t){return t.box.id===e.id})).box=e,n}))},Q=function(e){d((function(t){var n=Object(s.a)({},t),a=n.flowEntries.findIndex((function(t){return t.box.id===e.box.id}));return n.flowEntries[a]=Object(s.a)({},e),n}))},K=function(e,t){var n=l.flowEntries.find((function(t){return t.box.id===e}));n.box.name=t,Q(n)},Z=Object(a.useCallback)((function(e){return[].concat(Object(c.a)(q()),Object(c.a)(b)).map((function(e){return e.id})).includes(e)}),[l,b]),te=Object(a.useCallback)((function(e,t,n){e-=e%le.draggingGrid[0],t-=t%le.draggingGrid[1];for(var a=q().length;Z("box"+a);)a++;for(var o=prompt("Enter box name: ","box"+a);Z(o);)o=prompt("name taken,choose other: ");if(o){var r={isSynced:!1,details:{},box:{id:o,x:e,y:t,shape:n,flowDetailsModalOpen:!0,visible:!0}};d((function(e){var t=Object(s.a)({},e);return t.flowEntries=t.flowEntries.concat(r),t}))}}),[l.flowEntries.length,JSON.stringify(q().map((function(e){return e.flowDetailsModalOpen})))]),ne=Object(a.useCallback)((function(e){var t=e.dataTransfer.getData("shape");if(se.includes(t)){var n=e.target.getBoundingClientRect(),a=n.x,o=n.y;a=e.clientX-a,o=e.clientY-o,te(a,o,t)}}),[q().length,JSON.stringify(q().map((function(e){return e.flowDetailsModalOpen}))),U,te]),ae=Object(a.useCallback)((function(e,t){e.stopPropagation(),"Normal"===z?G(e,t):"Add Connections"!==z||U.id===t.id||t.id.includes(":<input>")?"Remove Connections"===z&&D((function(e){return e.filter((function(e){return!(e.start===U.id&&e.end===t.id)}))})):me(t)}),[z,U]),oe=Object(a.useCallback)((function(e){var t=null;return U&&U.id===e.id?t="rgb(200, 200, 200)":("Add Connections"===z&&0===N.filter((function(t){return t.start===U.id&&t.end===e.id})).length&&!e.id.includes(":<input>")||"Remove Connections"===z&&N.filter((function(t){return t.start===U.id&&t.end===e.id})).length>0)&&(t="LemonChiffon"),t}),[z,U]),re=Object(a.useCallback)((function(e){var t=e.startBoxId,n=e.endBoxId,a=l.flowEntries.find((function(e){return e.box.id===t})),o=l.flowEntries.find((function(e){return e.box.id===n}));a&&(a.details.actions.OUTPUT=n.replace(":<output>",""),je(a)),o&&(o.details.match.in_port=t.replace(":<input>",""),je(o))}),[l,U]),fe=Object(a.useCallback)((function(){_e(l.flowEntries.find((function(e){return e.box.id===U.id})))}),[l,U]),me=Object(a.useCallback)((function(e){re({startBoxId:U.id,endBoxId:e.id})}),[N.length,U]),be=function(e){var t=l.flowEntries.find((function(t){return t.box.id===e.start})),n=l.flowEntries.find((function(t){return t.box.id===e.end}));t&&(delete t.details.actions.OUTPUT,je(Object(s.a)({},t))),n&&(delete n.details.match.in_port,je(Object(s.a)({},n)))},he=Object(a.useCallback)((function(){be(U.id)}),[l,U]),ye=Object(a.useCallback)((function(){d((function(e){var t=Object(s.a)({},e);return q().find((function(e){return e.id===U.id})).flowDetailsModalOpen=!0,t}))}),[U]),Ee=function(e){var t;t=e.box.id,N.filter((function(e){return!(e.start===t||e.end===t)})).forEach((function(e){return be({start:e.start,end:e.end})})),d((function(t){var n=Object(s.a)({},t);n.flowEntries.findIndex((function(t){return B.a.isEqual(t,e)}));return n.flowEntries=n.flowEntries.filter((function(t){return!B.a.isEqual(t,e)})),n})),G(null)},Oe=function(e,t){var n=ue(e.details.actions),a=Object(s.a)(Object(s.a)({},e.details),{},{dpid:Number(l.dpid),actions:n}),o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};fetch(ve+"http://localhost:8080/stats/flowentry/delete_strict",o).then((function(e){200!==e.status?alert(e.status):t&&t()}))},_e=Object(a.useCallback)((function(e){if(!1!==window.confirm("are you sure you want to delete ".concat(e.box.name,"?")))return!1===e.isSynced?Ee(e):void Oe(e,(function(){return Ee(e)}))}),[l]),ge=function(e){return l.flowEntries.find((function(t){return JSON.stringify(t.details.match)===JSON.stringify(function(e){var t=Object(s.a)({},e);for(var n in e)"string"===typeof e[n]&&(t[n]=!1===isNaN(e[n])?Number(e[n]):e[n]);return t}(e))}))},we=Object(a.useCallback)((function(e,n){var a=e.details,o=a.match,r=void 0===o?{}:o,i=a.actions,c=void 0===i?{}:i,d=a.priority,u=void 0===d?1:d,p=ge(r);if(console.log(r),p)alert("the flow "+p.box.name+" with the same match rule already exist.\nFlows with same match rules are not allowed.");else{var f=ue(c),m=Object(s.a)(Object(s.a)({},e.details),{},{match:r,actions:f,priority:u,dpid:Number(l.dpid)}),b={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)};fetch(ve+"http://localhost:8080/stats/flowentry/add",b).then((function(a){200!==a.status?alert(a.status):function(e,n){var a={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({match:e})};fetch(ve+"http://localhost:8080/stats/flow/"+t,a).then((function(e){if(200===e.status)return e.json();alert(e.status)})).then((function(e){var a=e[Number(t)][0];n(Object(s.a)(Object(s.a)({},a),{},{match:de(a.match),actions:pe(a.actions)}))}))}(r,(function(t){if(!1!==Object(k.isEqual)(t.match,e.details.match)){var a=Object(s.a)(Object(s.a)({},e),{},{details:Object(s.a)({},t),isSynced:!0});Q(a),n&&n(a.details)}else{Oe(e);var o=l.flowEntries.find((function(e){return Object(k.isEqual)(e.details.match,t.match)})).box.name;alert("match rule conflicts with flow "+o+".(means that the "+JSON.stringify(e.details.match)+" rule also match the match rule of "+o+")\nPlease provide more detailed match rule.")}}))}))}}),[l]),je=function(e){xe(e,(function(){return Q(e)}))},xe=function(e,t){var n=ue(e.details.actions),a=Object(s.a)(Object(s.a)({},e.details),{},{actions:n,dpid:Number(l.dpid)}),o={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)};fetch(ve+"http://localhost:8080/stats/flowentry/modify_strict",o).then((function(e){200!==e.status?alert(e.status):t&&t()}))},Se=Object(a.useMemo)((function(){return{setPorts:h,updateBoxOnUi:X,setLines:D,selected:U,setSelected:R,actionState:z,setActionState:V,handleBoxClick:ae,chooseBoxBackground:oe,addBox:te,addLine:re,removeSelectedBox:fe,addLineToSelectedBox:me,removeSelectedLine:he,openModsWindowOfSelected:ye,handleSelect:G,toggleFlowVisibility:S,toggleFlowVisibilityOfSelected:P,delFlow:_e,addFlowToServer:we,updateFlowOnUi:Q,updateFlowOnServer:je,updateFlowName:K}}),[h,X,D,U,R,z,V,ae,oe,te,re,fe,me,he,ye,G,S,P,_e,Q,we,je,K]);return o.a.createElement("div",null,o.a.createElement("div",{className:"canvasStyle",id:"canvas",onClick:function(){return G(null)}},E?o.a.createElement(ce.Provider,{value:Se},o.a.createElement(H,{canvasProps:Se}),o.a.createElement("div",{className:"switchTopBar"},o.a.createElement("div",{className:"switchTitle"},l.name),o.a.createElement(u.a,{fontSize:"large",className:"infoButton",onClick:function(){return j(!w)}})),o.a.createElement("div",{className:"innerCanvas"},o.a.createElement(ee,null),o.a.createElement(J,{ports:b,portPolarity:"input",lines:N}),o.a.createElement(ie,{boxes:q(),handleDropBox:ne,lines:N}),o.a.createElement(J,{ports:b,portPolarity:"output"}),l.flowEntries.map((function(e){return e.box.visible?o.a.createElement(o.a.Fragment,{key:e.box.id},e.details.match&&e.details.match.in_port?o.a.createElement(f,{line:{start:e.details.match.in_port+":<input>",end:e.box.id}}):null,!e.details.actions||!1!==isNaN(e.details.actions.OUTPUT)&&"LOCAL"!==e.details.actions.OUTPUT?null:o.a.createElement(f,{line:{start:e.box.id,end:e.details.actions.OUTPUT+":<output>"}})):null})),l.flowEntries.map((function(e){return e.box.flowDetailsModalOpen?o.a.createElement(I,Object.assign({key:e.box.id},{flow:e})):null}))),w?o.a.createElement($,{setSwitchDetailsWindow:j,flowEntries:l.flowEntries}):null):o.a.createElement("div",{className:"mainWindow"},o.a.createElement("h3",null,"fetching switch data..."),o.a.createElement(Y.a,{size:150,color:"#123abc",loading:!0}))))},me=(n(107),n(51)),be=function(e){var t=e.switches;return o.a.createElement("div",{className:"mainWindow"},o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{className:"switchListTitle"},Object.keys(t).length>0?"Detected vSwitches:":"No Detected vSwitches."),Object.keys(t).map((function(e){var n=t[e],a=n.ports,r=n.name;return o.a.createElement(me.b,{to:"/switch/"+e,key:e,className:"switchList"},"".concat(r," (dpid=").concat(e," ports=").concat(a.map((function(e){return e.name})).toString(),")"))}))))},he=n(141),ve="http://localhost:9089/",ye=function(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)({}),l=Object(i.a)(c,2),s=l[0],d=l[1],u=Object(a.useState)(!1),p=Object(i.a)(u,2),f=p[0],m=p[1];return Object(a.useEffect)((function(){var e={};fetch(ve+"http://localhost:8080/stats/switches").then((function(e){return e.json()})).then((function(t){var n=t.map((function(t){return fetch(ve+"http://localhost:8080/stats/portdesc/"+t).then((function(e){return e.json()})).then((function(t){e=Object.assign(e,t)}),(function(e){throw e}))}));Promise.all(n).then((function(){var t={};for(var n in e)for(var a=0;a<e[n].length;a++)"LOCAL"===e[n][a].port_no&&(t[n]=Object.assign({ports:e[n]},{name:e[n][a].name}));d(t),r(!0)}))}),(function(e){throw m(!0),e}))}),[]),o.a.createElement(he.a,{maxWidth:"lg"},o.a.createElement("header",{className:"mainTitle"},"SDN Manager"),o.a.createElement("hr",null),n?o.a.createElement(me.a,null,o.a.createElement(M.c,null,o.a.createElement(M.a,{exact:!0,path:"/"},o.a.createElement(be,{switches:s})),o.a.createElement(M.a,{path:"/switch/:dpid"},o.a.createElement(fe,{switches:s})),o.a.createElement(M.a,{path:"*"},o.a.createElement("div",{className:"mainWindow"},o.a.createElement("h3",null,"404 Not Found"))))):o.a.createElement("div",{className:"mainWindow"},f?o.a.createElement("h3",null,"Can't connect to controller, or to ofctl_rest API at port 8080.",o.a.createElement("br",null),"(or in development - check proxy server is running)"):o.a.createElement("div",null,o.a.createElement("h3",null,"fetching switches..."),o.a.createElement(Y.a,{size:150,color:"#123abc",loading:!0}))),o.a.createElement("div",{style:{marginTop:30}}))},Ee=document.getElementById("root");Object(r.render)(a.createElement(ye,null),Ee)},84:function(e,t,n){e.exports=n(108)},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){}},[[84,1,2]]]);
//# sourceMappingURL=main.48b67860.chunk.js.map